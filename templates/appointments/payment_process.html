{% extends 'appointments/base_mobile.html' %}
{% block content %}
<div class="min-h-screen bg-white flex flex-col items-center justify-center p-6 text-center">
    <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mb-6"></div>
    <h2 class="text-xl font-bold text-secondary mb-2">Initiating Payment</h2>
    <p class="text-gray-500 text-sm mb-6">Please wait while we open the payment gateway...</p>
    
    <button id="rzp-button1" class="hidden">Pay</button>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
    "key": "{{ razorpay_merchant_key }}", 
    "amount": "{{ razorpay_amount }}", 
    "currency": "{{ currency }}",
    "name": "Physio Care",
    "description": "Consultation Fee",
    "order_id": "{{ razorpay_order_id }}", 
    "callback_url": "{{ callback_url }}",
    "prefill": {
        "name": "{{ patient.full_name }}",
        "email": "{{ patient.email }}",
        "contact": "{{ patient.phone }}"
    },
    "theme": {
        "color": "#0f766e"
    }
};
var rzp1 = new Razorpay(options);

window.onload = function() {
    rzp1.open();
    
    // Handle close (optional)
    rzp1.on('payment.failed', function (response){
        alert("Payment Failed");
        window.location.href = "{% url 'appointments:home' %}";
    });
};
</script>
{% endblock %}